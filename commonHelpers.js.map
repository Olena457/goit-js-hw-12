{"version":3,"file":"commonHelpers.js","sources":["../src/js/pixabay-api.js","../src/js/render-functions.js","../src/main.js"],"sourcesContent":["import axios from 'axios';\nexport async function fetchImages(query, page) {\n  const BASE_URL = 'https://pixabay.com/api/';\n\n  const KEY = '43261756-f7e91f342fa994673ba6d269c';\n\n  const OTHERS_PARAMS = `?key=${KEY}&q=${query}&image_type=photo&orientation=horizontal&safesearch=true&per_page=15&page=${page}`;\n\n  try {\n    const response = await axios.get(`${BASE_URL}${OTHERS_PARAMS}`);\n    return response.data;\n  } catch (error) {\n    console.error('Error fetching images:', error);\n    throw error;\n  }\n}\n","export const galleryEl = document.querySelector('.gallery');\n\nexport function renderImages(images) {\n  if (!Array.isArray(images)) {\n    console.error('Expected images to be an array');\n    return;\n  }\n\n  const markup = images.map(\n    ({\n      webformatURL,\n      largeImageURL,\n      tags,\n      likes,\n      views,\n      comments,\n      downloads,\n    }) => {\n      return ` \n      <li class=\"gallery-item\">\n    <a class=\"gallery-link\" href=\"${largeImageURL}\">\n    <img class=\"gallery-image\" src=\"${webformatURL}\" alt=\"${tags}\" loading=\"lazy\">\n    </a>\n    <div class='caption'>\n    <p class='caption-item'>\n      <b>Likes</b>\n      ${likes}\n    </p>\n    <p class='caption-item'>\n      <b>Views</b>\n      ${views}\n    </p>\n    <p class='caption-item'>\n      <b>Comments</b>\n      ${comments}\n    </p>\n    <p class='caption-item'>\n      <b>Downloads</b>\n      ${downloads}\n    </p>\n  </div>\n    </li>`;\n    }\n  );\n  return markup.join('');\n}\n","import iziToast from 'izitoast';\nimport 'izitoast/dist/css/iziToast.min.css';\n\nimport SimpleLightbox from 'simplelightbox';\nimport 'simplelightbox/dist/simple-lightbox.min.css';\n\nimport { fetchImages } from './js/pixabay-api';\nimport { galleryEl, renderImages } from './js/render-functions';\n\nconst searchForm = document.querySelector('.js-search');\nconst preloader = document.querySelector('.loader');\nconst loadMoreBtn = document.querySelector('.load-more');\n\nsearchForm.addEventListener('submit', handleSearchSubmit);\nloadMoreBtn.addEventListener('click', onClickMoreBtn);\n\nlet lightbox = new SimpleLightbox('.gallery a', {\n  captions: true,\n  captionsData: 'alt',\n  captionDelay: 250,\n});\n\nlet currentPage = 1;\nlet currentHits = 0;\nlet query = '';\nlet totalHits = 0;\n\nfunction generateRandomColor() {\n  const randomColor = () => Math.floor(Math.random() * 256);\n  return `rgb(${randomColor()}, ${randomColor()}, ${randomColor()})`;\n}\n\nfunction setBackgroundGradient() {\n  const color1 = generateRandomColor();\n  const color2 = generateRandomColor();\n  document.body.style.backgroundImage = `linear-gradient(45deg, ${color1}, ${color2})`;\n}\n\nasync function handleSearchSubmit(ev) {\n  ev.preventDefault();\n  setBackgroundGradient();\n  query = ev.target.elements.query.value.trim();\n  currentPage = 1;\n  loadMoreBtn.classList.add('hidden');\n  galleryEl.innerHTML = '';\n  searchForm.reset();\n\n  if (!query) {\n    iziToast.show({\n      title: 'Error',\n      message: `Please enter a search query!`,\n      position: 'topRight',\n      color: '#da1418',\n      timeout: 2000,\n    });\n    return;\n  }\n  preloader.classList.remove('hidden');\n\n  try {\n    const resp = await fetchImages(query, currentPage);\n    totalHits = resp.totalHits;\n    currentHits = resp.hits.length;\n\n    if (totalHits === 0) {\n      iziToast.error({\n        title: 'Error',\n        message: `Sorry, there are no images matching your search query. Please try again!`,\n        position: 'topRight',\n        color: '#da1418',\n        timeout: 2000,\n      });\n      return;\n    }\n\n    if (currentHits < 15) {\n      iziToast.info({\n        title: 'Info',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n        color: '#21d4bce0',\n        timeout: 2000,\n      });\n    } else {\n      galleryEl.innerHTML = renderImages(resp.hits);\n      loadMoreBtn.classList.toggle('hidden', totalHits <= currentHits);\n      lightbox.refresh();\n      scrollToNewImages();\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred. Please try again!',\n      position: 'topRight',\n      color: '#da1418',\n      timeout: 2000,\n    });\n  } finally {\n    preloader.classList.add('hidden');\n  }\n}\n\nasync function onClickMoreBtn() {\n  currentPage++;\n  try {\n    const resp = await fetchImages(query, currentPage);\n    addImagesToGallery(resp.hits);\n    currentHits += resp.hits.length;\n\n    if (currentHits >= totalHits) {\n      loadMoreBtn.classList.add('hidden');\n      iziToast.info({\n        title: 'Info',\n        message: `We're sorry, but you've reached the end of search results.`,\n        position: 'topRight',\n        color: '#21d4bce0',\n        timeout: 2000,\n      });\n    }\n  } catch (error) {\n    iziToast.error({\n      title: 'Error',\n      message: 'An error occurred. Please try again!',\n      position: 'topRight',\n      color: '#da1418',\n      timeout: 2000,\n    });\n  }\n}\n\nfunction addImagesToGallery(images) {\n  galleryEl.insertAdjacentHTML('beforeend', renderImages(images));\n  lightbox.refresh();\n}\nfunction scrollToNewImages() {\n  const { top } = galleryEl.getBoundingClientRect();\n  window.scrollTo({ top: top + window.scrollY, behavior: 'smooth' });\n}\n"],"names":["fetchImages","query","page","BASE_URL","OTHERS_PARAMS","axios","error","galleryEl","renderImages","images","webformatURL","largeImageURL","tags","likes","views","comments","downloads","searchForm","preloader","loadMoreBtn","handleSearchSubmit","onClickMoreBtn","lightbox","SimpleLightbox","currentPage","currentHits","totalHits","generateRandomColor","randomColor","setBackgroundGradient","color1","color2","ev","iziToast","resp","scrollToNewImages","addImagesToGallery","top"],"mappings":"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"}